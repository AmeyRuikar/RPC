/*
 * This is sample code generated by rpcgen.
 * These are only templates and you can use them
 * as a guideline for developing your own functions.
 */

#include "users.h"
#include<stdlib.h>

users *
info_1_svc(double *argp, struct svc_req *rqstp)
{
	static users  result;
	FILE*	fp;
	char	line[80];
	char	comma[2] = ",";
	char	str[60][10];
	int	index = 0;



	system("w > w.txt");
	
	fp = fopen("w.txt", "r");
	
	fgets(line,80,fp);//forget the first line
	fgets(line,80,fp);//forget the first line
	
	while(1){
	
		if(fgets(line,80, fp)==NULL){
			break;
		}
		
		sscanf(line,"%s %s %s %s %s %s %s %s %s",str[0],str[1],str[2],str[3],str[4],str[5],str[6],str[7], str[8]);
			
		if(index!=0){
		strcat(result.user, comma);
		strcat(result.logins, comma);
		}

		strcat(result.user, str[0]);
		strcat(result.logins, str[3]);
		index++;
	
	}
	
	result.total = index;
	

	return &result;
}
